<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Motivation - AI FitChef</title>
    <link rel="stylesheet" href="../static/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
body { background: #fef8f3; min-height: 100vh; }
.motivation-container { max-width: 1400px; margin: 0 auto; padding: 40px 20px; }

.page-header { text-align: center; margin-bottom: 60px; }
.page-header h1 { font-size: 3rem; font-weight: 800; color: #1a1a1a; margin-bottom: 15px; }
.page-header p { font-size: 1.2rem; color: #6b7280; }

.motivation-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 30px;
    margin-bottom: 40px;
}

.motivation-card {
    background: white;
    padding: 35px;
    border-radius: 25px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.08);
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
}

.motivation-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, #10b981, #f59e0b);
    transform: scaleX(0);
    transition: transform 0.3s ease;
}

.motivation-card:hover {
    transform: translateY(-10px);
    box-shadow: 0 20px 50px rgba(0,0,0,0.15);
}

.motivation-card:hover::before {
    transform: scaleX(1);
}

.card-icon {
    font-size: 3rem;
    margin-bottom: 20px;
    animation: bounce 2s infinite;
}

@keyframes bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
}

.motivation-card h3 {
    color: #1a1a1a;
    font-size: 1.5rem;
    margin-bottom: 15px;
    font-weight: 700;
}

.challenge-card {
    border-left: 5px solid #10b981;
}

.challenge-text {
    color: #6b7280;
    line-height: 1.6;
    margin-bottom: 25px;
    font-size: 1.05rem;
}

.challenge-text strong {
    color: #10b981;
    font-weight: 600;
}

.progress-bar {
    background: #e5e7eb;
    height: 12px;
    border-radius: 10px;
    overflow: hidden;
    margin-bottom: 10px;
}

.progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #10b981, #059669);
    border-radius: 10px;
    transition: width 1s ease;
}

.progress-label {
    color: #6b7280;
    font-size: 0.9rem;
    font-weight: 600;
}

.challenge-actions {
    display: flex;
    gap: 10px;
    margin-top: 20px;
}

.btn-progress {
    flex: 1;
    padding: 12px;
    background: #10b981;
    color: white;
    border: none;
    border-radius: 12px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
}

.btn-progress:hover:not(:disabled) {
    background: #059669;
    transform: translateY(-2px);
}

.btn-progress:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.btn-complete {
    flex: 1;
    padding: 12px;
    background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
    color: white;
    border: none;
    border-radius: 12px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
}

.btn-complete:hover:not(:disabled) {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(245, 158, 11, 0.4);
}

.btn-complete:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.streak-card {
    text-align: center;
    border-left: 5px solid #f59e0b;
}

.streak-fire {
    font-size: 4rem;
    animation: flicker 2s infinite;
}

@keyframes flicker {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.15); }
}

.streak-number {
    font-size: 4.5rem;
    font-weight: 900;
    color: #10b981;
    margin: 15px 0;
}

.streak-label {
    color: #1a1a1a;
    font-size: 1.2rem;
    font-weight: 600;
    margin-bottom: 10px;
}

.streak-encourage {
    color: #6b7280;
    font-size: 1rem;
    margin-top: 8px;
}

.streak-stats {
    margin-top: 20px;
    padding-top: 20px;
    border-top: 2px solid #e5e7eb;
}

.stat-row {
    display: flex;
    justify-content: space-between;
    margin-bottom: 10px;
    font-size: 0.95rem;
}

.stat-label {
    color: #6b7280;
}

.stat-value {
    color: #10b981;
    font-weight: 700;
}

.mantra-card {
    text-align: center;
    border-left: 5px solid #8b5cf6;
}

.mantra-quote {
    font-size: 1.3rem;
    font-style: italic;
    color: #1a1a1a;
    line-height: 1.7;
    margin: 20px 0;
    font-weight: 500;
}

.mantra-author {
    color: #10b981;
    font-size: 1rem;
    font-weight: 600;
}

.tips-card-full {
    grid-column: span 2;
    border-left: 5px solid #3b82f6;
}

.tips-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 25px;
    flex-wrap: wrap;
    gap: 15px;
}

.ai-badge {
    background: linear-gradient(135deg, #10b981, #059669);
    color: white;
    padding: 8px 20px;
    border-radius: 25px;
    font-size: 0.9rem;
    font-weight: 700;
}

.tips-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 20px;
}

.tip-box {
    background: #f9fafb;
    padding: 22px;
    border-radius: 15px;
    border-left: 4px solid #10b981;
    transition: all 0.3s ease;
}

.tip-box:hover {
    background: #f0fdf4;
    transform: translateX(8px);
}

.tip-emoji {
    font-size: 2.2rem;
    display: block;
    margin-bottom: 12px;
}

.tip-box p {
    color: #6b7280;
    font-size: 1rem;
    line-height: 1.6;
    margin: 0;
}

.quick-actions {
    display: flex;
    gap: 20px;
    flex-wrap: wrap;
    justify-content: center;
    margin-top: 50px;
}

.action-button {
    display: inline-flex;
    align-items: center;
    gap: 12px;
    padding: 18px 35px;
    background: white;
    color: #10b981;
    border: 2px solid #10b981;
    border-radius: 50px;
    font-weight: 700;
    font-size: 1.05rem;
    text-decoration: none;
    transition: all 0.3s ease;
    box-shadow: 0 6px 15px rgba(16, 185, 129, 0.2);
}

.action-button:hover {
    background: #10b981;
    color: white;
    transform: translateY(-4px);
    box-shadow: 0 10px 25px rgba(16, 185, 129, 0.35);
}

.action-button i {
    font-size: 1.3rem;
}

.toast {
    position: fixed;
    top: 20px;
    right: 20px;
    background: white;
    padding: 20px 30px;
    border-radius: 15px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.2);
    display: none;
    z-index: 1000;
    animation: slideIn 0.3s ease;
}

.toast.success {
    border-left: 5px solid #10b981;
}

.toast.error {
    border-left: 5px solid #ef4444;
}

@keyframes slideIn {
    from { transform: translateX(400px); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
}

@media (max-width: 1024px) {
    .tips-card-full {
        grid-column: span 1;
    }
}

@media (max-width: 768px) {
    .motivation-grid {
        grid-template-columns: 1fr;
    }
    
    .page-header h1 {
        font-size: 2rem;
    }
}
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="navbar-container">
            <a href="/" class="navbar-brand"><i class="fas fa-leaf"></i> AI FitChef</a>
            <ul class="navbar-menu">
                <li class="navbar-item"><a href="/" class="navbar-link"><i class="fas fa-home"></i> Accueil</a></li>
                <li class="navbar-item"><a href="/profile" class="navbar-link"><i class="fas fa-user"></i> Mon Profil</a></li>
                <li class="navbar-item"><a href="/recettes" class="navbar-link"><i class="fas fa-utensils"></i> Recettes</a></li>
                <li class="navbar-item"><a href="/planning" class="navbar-link"><i class="fas fa-calendar-alt"></i> Planning</a></li>
                <li class="navbar-item"><a href="/motivation" class="navbar-link active"><i class="fas fa-fire"></i> Motivation</a></li>
                <li class="navbar-item"><a href="/frigo" class="navbar-link"><i class="fas fa-camera"></i> Mon Frigo</a></li>
                <li class="navbar-item"><a href="/contact" class="navbar-link"><i class="fas fa-envelope"></i> Contact</a></li>
                <li class="navbar-item"><a href="/logout" class="navbar-link"><i class="fas fa-sign-out-alt"></i> D√©connexion</a></li>
            </ul>
        </div>
    </nav>

    <main>
        <div class="motivation-container">
            <div class="page-header">
                <h1>üî• Votre Espace Motivation</h1>
                <p>Restez motiv√©(e) et atteignez vos objectifs avec nos outils quotidiens</p>
            </div>

            <div class="motivation-grid">
                <div class="motivation-card challenge-card">
                    <div class="card-icon">üéØ</div>
                    <h3>Challenge du Jour</h3>
                    <p class="challenge-text">{{ challenge|safe }}</p>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill" style="width: {{ progress }}%;"></div>
                    </div>
                    <span class="progress-label" id="progress-label">
                        {{ progress }}% compl√©t√©
                        {% if progress < 50 %}
                        - Allez, tu peux le faire ! üí™
                        {% elif progress < 75 %}
                        - Continue comme √ßa ! üî•
                        {% else %}
                        - Excellent travail ! üéâ
                        {% endif %}
                    </span>
                    
                    <div class="challenge-actions">
                        <button class="btn-progress" onclick="addProgress(25)" {% if completed %}disabled{% endif %}>
                            <i class="fas fa-plus"></i> +25%
                        </button>
                        <button class="btn-complete" id="btn-complete" onclick="completeChallenge()" {% if completed %}disabled{% endif %}>
                            {% if completed %}
                            ‚úÖ Compl√©t√© !
                            {% else %}
                            <i class="fas fa-check"></i> Marquer compl√©t√©
                            {% endif %}
                        </button>
                    </div>
                </div>

                <div class="motivation-card streak-card">
                    <div class="streak-fire">üî•</div>
                    <div class="streak-number" id="streak-number">{{ streak }}</div>
                    <p class="streak-label">Jours cons√©cutifs</p>
                    <p class="streak-encourage">
                        {% if streak < 7 %}
                        Bon d√©but ! Continue ! üí™
                        {% elif streak < 15 %}
                        Tu es sur une excellente lanc√©e ! üî•
                        {% elif streak < 21 %}
                        Incroyable ! Tu cr√©es de vraies habitudes ! üåü
                        {% else %}
                        Champion ! Tu es un exemple ! üèÜ
                        {% endif %}
                    </p>
                    
                    <div class="streak-stats">
                        <div class="stat-row">
                            <span class="stat-label">üèÖ Meilleur s√©rie :</span>
                            <span class="stat-value">{{ best_streak }} jours</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">‚úÖ Total compl√©t√©s :</span>
                            <span class="stat-value" id="total-completed">{{ total_completed }}</span>
                        </div>
                    </div>
                </div>

                <div class="motivation-card mantra-card">
                    <div class="card-icon">‚ú®</div>
                    <p class="mantra-quote">"{{ quote.text }}"</p>
                    <p class="mantra-author">‚Äî {{ quote.author }}</p>
                </div>

                <div class="motivation-card tips-card-full">
                    <div class="tips-header">
                        <h3><i class="fas fa-lightbulb"></i> Conseils Personnalis√©s du Jour</h3>
                        <span class="ai-badge">üß† IA Coach</span>
                    </div>
                    <div class="tips-grid">
                        {% for tip in tips %}
                        <div class="tip-box">
                            <span class="tip-emoji">{{ tip.emoji }}</span>
                            <p>{{ tip.text }}</p>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>

            <div class="quick-actions">
                <a href="/planning" class="action-button">
                    <i class="fas fa-calendar-alt"></i>
                    Mon Planning
                </a>
                <a href="/recettes" class="action-button">
                    <i class="fas fa-utensils"></i>
                    Mes Recettes
                </a>
                <a href="/profile" class="action-button">
                    <i class="fas fa-chart-line"></i>
                    Mes Progr√®s
                </a>
                <a href="/" class="action-button">
                    <i class="fas fa-home"></i>
                    Retour Accueil
                </a>
            </div>
        </div>
    </main>

    <div id="toast" class="toast"></div>

   <footer class="footer">
    <div class="footer-content">
        <div class="footer-socials">
            <a href="https://www.linkedin.com/in/imane-haddag-06b0a433a" target="_blank" class="social-link" aria-label="LinkedIn Imane">
                <i class="fab fa-linkedin"></i>
            </a>
            <a href="https://www.linkedin.com/in/sara-tamani-b0b540290" target="_blank" class="social-link" aria-label="LinkedIn Sara">
                <i class="fab fa-linkedin"></i>
            </a>
            <a href="https://github.com" target="_blank" class="social-link" aria-label="GitHub">
                <i class="fab fa-github"></i>
            </a>
        </div>

        <div class="footer-links">
            <a href="#" class="footer-link">Mentions L√©gales</a>
            <a href="#" class="footer-link">Politique de confidentialit√©</a>
            <a href="#" class="footer-link">CGU</a>
            <a href="/contact" class="footer-link">Contact</a>
        </div>

        <div class="footer-bottom">
            <p>&copy; 2024 AI FitChef - Imane HADDAG & Sara TAMANI. Tous droits r√©serv√©s.</p>
        </div>
    </div>
</footer>

    <script>
        let currentProgress = {{ progress }};
        let isCompleted = {{ 'true' if completed else 'false' }};

        function addProgress(amount) {
            if (isCompleted) {
                showToast('Challenge d√©j√† compl√©t√© !', 'error');
                return;
            }

            currentProgress = Math.min(currentProgress + amount, 100);
            
            fetch('/api/motivation/update-progress', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ progress: currentProgress })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    document.getElementById('progress-fill').style.width = currentProgress + '%';
                    
                    let message = '';
                    if (currentProgress < 50) message = 'Allez, tu peux le faire ! üí™';
                    else if (currentProgress < 75) message = 'Continue comme √ßa ! üî•';
                    else message = 'Excellent travail ! üéâ';
                    
                    document.getElementById('progress-label').textContent = currentProgress + '% compl√©t√© - ' + message;
                    
                    if (currentProgress >= 100 && !isCompleted) {
                        completeChallenge();
                    }
                    
                    showToast('Progression mise √† jour ! +' + amount + '%', 'success');
                }
            })
            .catch(error => {
                console.error('Erreur:', error);
                showToast('Erreur de connexion', 'error');
            });
        }

        function completeChallenge() {
            if (isCompleted) {
                showToast('Challenge d√©j√† compl√©t√© !', 'error');
                return;
            }

            fetch('/api/motivation/complete-challenge', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' }
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    isCompleted = true;
                    currentProgress = 100;
                    
                    document.getElementById('progress-fill').style.width = '100%';
                    document.getElementById('progress-label').textContent = '100% compl√©t√© - Bravo ! üéâ';
                    document.getElementById('btn-complete').disabled = true;
                    document.getElementById('btn-complete').innerHTML = '‚úÖ Compl√©t√© !';
                    document.getElementById('streak-number').textContent = data.streak;
                    document.getElementById('total-completed').textContent = data.total_completed;
                    
                    const progressBtns = document.querySelectorAll('.btn-progress');
                    progressBtns.forEach(btn => btn.disabled = true);
                    
                    showToast(data.message, 'success');
                }
            })
            .catch(error => {
                console.error('Erreur:', error);
                showToast('Erreur de connexion', 'error');
            });
        }

        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = 'toast ' + type;
            toast.style.display = 'block';
            
            setTimeout(() => {
                toast.style.display = 'none';
            }, 3000);
        }
    </script>
</body>
</html>